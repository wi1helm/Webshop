

let products = [{id:"angel_war",title:"Angel War",theme:"Fantasy",decs:"Obama",price:"120Kr",img:"../images/new/Angle_War.png"},
                {id:"mount_resv",title:"Mountain Reserve",theme:"Nature",decs:"Obama",price:"160Kr",img:"../images/new/Montain_Reserve.png"},
                {id:"wavy_fall",title:"Wavy Waterfall",theme:"Nature",decs:"Obama",price:"99Kr",img:"../images/new/Wavy_Waterfall.png"},
                {id:"world_prot",title:"World Protest",theme:"Sci-Fi",decs:"Obama",price:"149Kr",img:"../images/new/World_Protest.png"},
                {id:"ethereal_sunrise",title:"Ethereal Sunrise",theme:"Fantasy",decs:"Obama",price:"99Kr",img:"../images/low/Ethereal Sunrise.png"},
                {id:"melancholy_city",title:"The Melancholy City",theme:"Fantasy",decs:"Obama",price:"60Kr",img:"../images/low/The Melancholy City.png"},
                {id:"urban_jungle",title:"Urban Jungle",theme:"Nature",decs:"Obama",price:"50Kr",img:"../images/low/Urban Jungle.png"},
                {id:"world_color",title:"World Of Color",theme:"Fantasy",decs:"Obama",price:"40Kr",img:"../images/low/world of color.png"},
                {id:"castle_clouds",title:"Castle in the Clouds",theme:"Fantasy",decs:"Obama",price:"160Kr",img:"../images/fantasy/Castle_in_the_Clouds.png"},
                {id:"dragons_lair",title:"Dragons Lair",theme:"Fantasy",decs:"Obama",price:"199Kr",img:"../images/fantasy/Dragons_Lair.png"},
                {id:"enchanted_waterfall",title:"Enchanted Waterfall",theme:"Fantasy",decs:"Obama",price:"170r",img:"../images/fantasy/Enchanted_Waterfall.png"},
                {id:"faerie_ring",title:"Faerie Ring",theme:"Fantasy",decs:"Obama",price:"99Kr",img:"../images/fantasy/Faerie_Ring.png"},
                {id:"fairy_garden",title:"Fairy Garden",theme:"Fantasy",decs:"Obama",price:"150Kr",img:"../images/fantasy/Fairy_Garden.png"},
                {id:"giants_playground",title:"Giants Playground",theme:"Fantasy",decs:"Obama",price:"99Kr",img:"../images/fantasy/Giants_Playground.png"},
                {id:"magic_mirror",title:"Magic Mirror",theme:"Fantasy",decs:"Obama",price:"120Kr",img:"../images/fantasy/Magic_Mirror.png"},
                {id:"mermaids_cove",title:"Mermaids Cove",theme:"Fantasy",decs:"Obama",price:"99Kr",img:"../images/fantasy/Mermaids_Cove.png"},
                {id:"phonix_rising",title:"Phonix Rising",theme:"Fantasy",decs:"Obama",price:"199Kr",img:"../images/fantasy/Phonix_Rising.png"},
                {id:"crystal_castle",title:"The Crystal Castle",theme:"Fantasy",decs:"Obama",price:"130Kr",img:"../images/fantasy/The_Crystal_Castle.png"},
                {id:"dark_tower",title:"The Dark Tower",theme:"Fantasy",decs:"Obama",price:"120Kr",img:"../images/fantasy/The_Dark_Tower.png"},
                {id:"the_enchanted_forest",title:"The Enchanted Forest",theme:"Fantasy",decs:"Obama",price:"150Kr",img:"../images/fantasy/The_Enchanted_Forest.png"},
                {id:"lost_city",title:"The Lost City",theme:"Fantasy",decs:"Obama",price:"99Kr",img:"../images/fantasy/The_Lost_City.png"},
                {id:"quintet",title:"The Quintet",theme:"Fantasy",decs:"Obama",price:"199Kr",img:"../images/fantasy/The_Quintet.png"},
                {id:"unicorn_meadows",title:"Unicorn_Meadows",theme:"Fantasy",decs:"Obama",price:"100Kr",img:"../images/fantasy/Unicorn_Meadows.png"},
                {id:"wizards_workshop",title:"Wizards Workshop",theme:"Fantasy",decs:"Obama",price:"80Kr",img:"../images/fantasy/Wizards_Workshop.png"},
                {id:"autumn_leaves",title:"Autumn Leaves",theme:"Nature",decs:"Obama",price:"120Kr",img:"../images/nature/Autumn_Leaves.png"},
                {id:"bird_sancturary",title:"Bird Sanctuary",theme:"Nature",decs:"Obama",price:"99Kr",img:"../images/nature/Bird_Sanctuary.png"},
                {id:"forest",title:"The Forest",theme:"Nature",decs:"Obama",price:"140Kr",img:"../images/nature/Forest.png"},
                {id:"hidden_cave",title:"Hidden Cave",theme:"Nature",decs:"Obama",price:"160Kr",img:"../images/nature/Hidden_Cave"},
                {id:"majestic_waterfall",title:"Majestic Waterfall",theme:"Nature",decs:"Obama",price:"120Kr",img:"../images/nature/Majestic_Waterfall.png"},
                {id:"misty_mountains",title:"Misty Mountains",theme:"Nature",decs:"Obama",price:"140Kr",img:"../images/nature/Misty_Mountains.png"},
                {id:"northern_lights",title:"Northern Lights",theme:"Nature",decs:"Obama",price:"199Kr",img:"../images/nature/Northern_Lights.png"},
                {id:"oceans_edge",title:"Oceans Edge",theme:"Nature",decs:"Obama",price:"140Kr",img:"../images/nature/Oceans_Edge.png"},
                {id:"rainbow_canyon",title:"Rainbow Canyon",theme:"Nature",decs:"Obama",price:"99Kr",img:"../images/nature/Rainbow_Canyon.png"},
                {id:"rocky_shoreline",title:"Rocky Shoreline",theme:"Nature",decs:"Obama",price:"149Kr",img:"../images/nature/Rocky_Shoreline.png"},
                {id:"rolling_hills",title:"Rolling Hills",theme:"Nature",decs:"Obama",price:"110Kr",img:"../images/nature/Rolling_Hills.png"},
                {id:"serene_lake",title:"Serene Lake",theme:"Nature",decs:"Obama",price:"170Kr",img:"../images/nature/Serene_Lake.png"},
                {id:"sunflower_fields",title:"Sunflower Fields",theme:"Nature",decs:"Obama",price:"240Kr",img:"../images/nature/Sunflower_Fields.png"},
                {id:"sunset_beach",title:"Sunset on the Beach",theme:"Nature",decs:"Obama",price:"230Kr",img:"../images/nature/Sunset_on_the_Beach.png"},
                {id:"wildflower_meadow",title:"Wildflower Meadow",theme:"Nature",decs:"Obama",price:"170Kr",img:"../images/nature/Wildflower_Meadow.png"},
                {id:"winter_wonderland",title:"Winter Wonderland",theme:"Nature",decs:"Obama",price:"200Kr",img:"../images/nature/Winter_Wonderland.png"},
                {id:"alien_invasion",title:"Alien Invasion",theme:"Sci-Fi",decs:"Obama",price:"210Kr",img:"../images/sci-fi/Alien_Invasion.png"},
                {id:"android_uprising",title:"Android Uprising",theme:"Sci-Fi",decs:"Obama",price:"180Kr",img:"../images/sci-fi/Android_Uprising.png"},
                {id:"artifcial_intellifence_dominion",title:"Artifcial Intellifence Dominion",theme:"Sci-Fi",decs:"Obama",price:"400Kr",img:"../images/sci-fi/Artifcial_Intellifence_Dominion.png"},
                {id:"cyber_cityscape",title:"Cyber Cityscape",theme:"Sci-Fi",decs:"Obama",price:"170Kr",img:"../images/sci-fi/Cyber_Cityscape.png"},
                {id:"cyberpunkt_metropolis",title:"Cyberpunk Meropolis",theme:"Sci-Fi",decs:"Obama",price:"50Kr",img:"../images/sci-fi/Cyberpunk_Metropolis.png"},
                {id:"deep_space_exploreation",title:"Deep Space Exploreation",theme:"Sci-Fi",decs:"Obama",price:"120Kr",img:"../images/sci-fi/Deep_Space_Exploreation.png"},
                {id:"dystopian_future",title:"Dystopian Future",theme:"Sci-Fi",decs:"Obama",price:"190Kr",img:"../images/sci-fi/Dystopian_Future.png"},
                {id:"galactic_battlefront",title:"Galactic Battlefront",theme:"Sci-Fi",decs:"Obama",price:"160Kr",img:"../images/sci-fi/Galactic_Battlefront.png"},
                {id:"intergalactic_trade_hub",title:"Intergalactic Trade Hub",theme:"Sci-Fi",decs:"Obama",price:"150Kr",img:"../images/sci-fi/Intergalactic_Trade_Hub.png"},
                {id:"interstellar_wormhole",title:"Interstellar Wormhole",theme:"Sci-Fi",decs:"Obama",price:"260Kr",img:"../images/sci-fi/Interstellar_Wormhole.png"},
                {id:"quantum_realm",title:"Quantum Realm",theme:"Sci-Fi",decs:"Obama",price:"170Kr",img:"../images/sci-fi/Quantum_Realm.png"},
                {id:"robots_moon",title:"Robot on the Moon",theme:"Sci-Fi",decs:"Obama",price:"210Kr",img:"../images/sci-fi/Robot_on_the_Moon.png"},
                {id:"starship_enterprise",title:"Starship Enterprise",theme:"Sci-Fi",decs:"Obama",price:"100Kr",img:"../images/sci-fi/Starship_Enterprise.png"},
                {id:"terraforming_mars",title:"Terraforming Mars",theme:"Sci-Fi",decs:"Obama",price:"100Kr",img:"../images/sci-fi/Terraforming_Mars.png"},
                {id:"the_singlarity",title:"The Singlarity",theme:"Sci-Fi",decs:"Obama",price:"100Kr",img:"../images/sci-fi/The_Singlarity.png"},
                {id:"parallel_universe",title:"Parallel Universe",theme:"Sci-Fi",decs:"Obama",price:"200Kr",img:"../images/sci-fi/Parallel_Universe.png"},
                {id:"art_deco_elegance",title:"Art Deco Elegance",theme:"Architecture",decs:"Obama",price:"120Kr",img:"../images/architecture/Art_Deco_Elegance.png"},
                {id:"brutalist_beauty",title:"Brutalist Beauty",theme:"Architecture",decs:"Obama",price:"140Kr",img:"../images/architecture/Brutalist_Beauty.png"},
                {id:"classical_splendor",title:"Classical Splendor",theme:"Architecture",decs:"Obama",price:"160Kr",img:"../images/architecture/Classical_Splendor.png"},
                {id:"contemporary_minimalism",title:"Contemporary Minimalism",theme:"Architecture",decs:"Obama",price:"200Kr",img:"../images/architecture/Contemporary_Minimalism.png"},
                {id:"eastern_opulence",title:"Eastern Opulence",theme:"Architecture",decs:"Obama",price:"160Kr",img:"../images/architecture/Eastern_Opulence.png"},
                {id:"futuristic_cityscape",title:"Futuristic Cityscape",theme:"Architecture",decs:"Obama",price:"120Kr",img:"../images/architecture/Futuristic_Cityscape.png"},
                {id:"geometric_shapes",title:"Geometric Shapes",theme:"Architecture",decs:"Obama",price:"110Kr",img:"../images/architecture/Geometric_Shapes.png"},
                {id:"gothic_cathedral",title:"Gothic Cathedral",theme:"Architecture",decs:"Obama",price:"140Kr",img:"../images/architecture/Gothic_Cathedral.png"},
                {id:"historic_landmark",title:"Historic Landmark",theme:"Architecture",decs:"Obama",price:"170Kr",img:"../images/architecture/Historic_Landmark.png"},
                {id:"industrial_strength",title:"Industrial Strength",theme:"Architecture",decs:"Obama",price:"260Kr",img:"../images/architecture/Industrial_Strength.png"},
                {id:"mediterranean_romance",title:"Mediterranean Romance",theme:"Architecture",decs:"Obama",price:"210Kr",img:"../images/architecture/Mediterranean_Romance.png"},
                {id:"modernist_masterpiece",title:"Modernist Masterpiece",theme:"Architecture",decs:"Obama",price:"240Kr",img:"../images/architecture/Modernist_Masterpiece.png"},
                {id:"postmodern_palace",title:"Postmodern Palace",theme:"Architecture",decs:"Obama",price:"180Kr",img:"../images/architecture/Postmodern_Palace.png"},
                {id:"rustic_charm",title:"Rustic Charm",theme:"Architecture",decs:"Obama",price:"190Kr",img:"../images/architecture/Rustic_Charm.png"},
                {id:"scenic_lighthouse",title:"Scenic Lighthouse",theme:"Architecture",decs:"Obama",price:"140Kr",img:"../images/architecture/Scenic_Lighthouse.png"},
                {id:"skyscraper_sunrise",title:"Skyscraper Sunrise",theme:"Architecture",decs:"Obama",price:"150Kr",img:"../images/architecture/Skyscraper_Sunrise.png"},
            ]           
let cart = [];



function search(){
    var input;
    var results = 0;
    document.getElementById("products_list").innerHTML = '';
    input = document.getElementById("search").value;
    console.log(input);
    products.forEach(element => {
            if (element.id.includes(input) && results < 8){
                results += 1;
                console.log(element.id.includes(input));
                document.getElementById("products_list").innerHTML += '<li><a onclick="saveClick(\'' + element.id + '\')">'+element.title+'</a></li>';
            }
    });
    if (input == "" || results == 0){
        document.getElementById("products_list").innerHTML = '';
        document.getElementById("search_content").style.display = "none";
    }
    else{
        document.getElementById("search_content").style.display = "block";
    }
}


function saveClick(id){
    console.log(id);
    sessionStorage.setItem("lastClick", id);
    location.href = "../product_template/product.html";
}

function load(){
    lastclick = sessionStorage.getItem("lastClick");
    if (lastclick == undefined){
        location.href = "../index.html";
    }
    console.log(lastclick);
    document.getElementById("title").innerHTML = products.find(x => x.id === lastclick).title;
    document.getElementById("theme").innerHTML = products.find(x => x.id === lastclick).theme;
    document.getElementById("desc").innerHTML = products.find(x => x.id === lastclick).decs;
    document.getElementById("price").innerHTML = products.find(x => x.id === lastclick).price;
    document.getElementById("img").src = products.find(x => x.id === lastclick).img;
    
}
function productAddCart(){
    id = sessionStorage.getItem("lastClick");
    addProduct(id);
}

function openCart(){
    document.getElementById("background").style.display = "block";
    document.getElementById("background").style.height = document.getElementById('cart_content').offsetHeight+130+"px"
    document.getElementById("background").style.zIndex = "10";
 
    document.getElementById("content").style.position ="fixed";
}
function closeCart(){

    document.getElementById("background").style.height = 0;
    document.getElementById("background").style.display = "none";
    document.getElementById("background").style.zIndex = "0";
    document.getElementById("content").style.position ="";
    location.href = "#top";
    console.log("nub");

}



function loadCart() {
    if (JSON.parse(sessionStorage.getItem("cart")) == null){
        sessionStorage.setItem("cart",JSON.stringify([]));
    }
    new_cart = JSON.parse(sessionStorage.getItem("cart"))
    var total = 0;
    var subAmount = 0;
    new_cart.forEach(element => {
        total += parseInt(element.price);
        subAmount += parseInt(element.amount)
    });
    var defualtCartTop = '<div class="cart_header"><h3 class="heading">Shopping Cart</h3><h3 class="heading" id="close" onclick="closeCart()">Close</h3><h3 class="action" onclick="clearCart()" >Remove all</h3></div>';
    var defualtCartBottom = '<div class="checkout"><div class="total"><div><div class="Subtotal">Sub-Total</div><div class="items">'+ subAmount +' items</div></div><div class="total-amount">'+total+'kr</div></div><a href="../complete_order/order_complete.html"><h1 class="button">Checkout</h1></a></div>';
    var items = "";
    new_cart.forEach(element => {
        items += '<div class="cart_items"><img src='+ element.img +' style="width:50px;"/><h1 class="title">'+ element.title +'</h1><div class="counter"><div class="btn" onclick="addAmount(\'' + element.id + '\')" >+</div><div class="count">'+element.amount+'</div><div class="btn" onclick="removeAmount(\'' + element.id + '\')" >-</div></div><div class="prices"><div class="amount">'+ element.price +"Kr"+'</div><div class="remove" onclick="removeItem(\'' + element.id + '\')">Remove</div></div></div>';
    });
    document.getElementById("cart_content").innerHTML = defualtCartTop + items + defualtCartBottom;
    
}

function addProduct(id) {
    
    new_product = products.find(x => x.id === id);
    new_product.amount = 1;
    cart.push(new_product);
    sessionStorage.setItem("cart",JSON.stringify(cart));
    console.log(cart);
}
function clearCart(){
    cart = [];
    sessionStorage.setItem("cart",JSON.stringify([]))
    loadCart();
    openCart();
    console.log("gfd");
}
function removeItem(id) {
    let updated_cart = JSON.parse(sessionStorage.getItem("cart"));
    console.log(updated_cart);
    let index = updated_cart.findIndex(x => x.id === id);
    updated_cart.splice(index, 1);
    sessionStorage.setItem("cart", JSON.stringify(updated_cart));
    console.log(JSON.parse(sessionStorage.getItem("cart")));
    loadCart();
    console.log("obama");
  }

  function addAmount(id){
    console.log("obama")
    let updated_cart = JSON.parse(sessionStorage.getItem("cart"));
    if (updated_cart.find(x => x.id === id).amount < 10){
        updated_cart.find(x => x.id === id).amount += 1;
        updated_cart.find(x => x.id === id).price = parseInt(updated_cart.find(x => x.id === id).amount) * parseInt(products.find(x => x.id === id).price);
    }
    sessionStorage.setItem("cart", JSON.stringify(updated_cart));
    loadCart()
}

function removeAmount(id){
    let updated_cart = JSON.parse(sessionStorage.getItem("cart"));
    if (updated_cart.find(x => x.id === id).amount > 1){
        updated_cart.find(x => x.id === id).amount -= 1;
        updated_cart.find(x => x.id === id).price = parseInt(updated_cart.find(x => x.id === id).amount) * parseInt(products.find(x => x.id === id).price);
    }
    sessionStorage.setItem("cart", JSON.stringify(updated_cart));
    loadCart()
}